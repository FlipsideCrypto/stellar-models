{{ config (
    materialized = 'view'
) }}
{{ streamline_external_table_FR_query_v2(
    model = "enriched_history_operations",
    partition_function = "TO_DATE( SPLIT_PART(SPLIT_PART(file_name, '/', 3), '=', 2)|| '01', 'YYYYMMDD')",
    partition_name = "partition_id",
    unique_key = "OP_ID",
    other_cols = 'ACCOUNT, AMOUNT, ASSET_CODE, ASSET_ISSUER, ASSET_TYPE, ASSET_ID, AUTHORIZE, BALANCE_ID, BUYING_ASSET_CODE, BUYING_ASSET_ISSUER, BUYING_ASSET_TYPE, BUYING_ASSET_ID,"from", FUNDER, HIGH_THRESHOLD, HOME_DOMAIN, INFLATION_DEST,"into","limit", LOW_THRESHOLD, MASTER_KEY_WEIGHT, MED_THRESHOLD, NAME, OFFER_ID, PATH, PRICE, D, N, SELLING_ASSET_CODE, SELLING_ASSET_ISSUER, SELLING_ASSET_TYPE, SELLING_ASSET_ID, SET_FLAGS, SET_FLAGS_S, SIGNER_KEY, SIGNER_WEIGHT, SOURCE_AMOUNT, SOURCE_ASSET_CODE, SOURCE_ASSET_ISSUER, SOURCE_ASSET_TYPE, SOURCE_ASSET_ID, SOURCE_MAX, STARTING_BALANCE,"to", TRUSTEE, TRUSTOR, TRUSTLINE_ASSET,"value", CLEAR_FLAGS, CLEAR_FLAGS_S, DESTINATION_MIN, BUMP_TO, SPONSOR, SPONSORED_ID, BEGIN_SPONSOR, AUTHORIZE_TO_MAINTAIN_LIABILITIES, CLAWBACK_ENABLED, LIQUIDITY_POOL_ID, RESERVE_A_ASSET_TYPE, RESERVE_A_ASSET_ID, RESERVE_A_ASSET_CODE, RESERVE_A_ASSET_ISSUER, RESERVE_A_MAX_AMOUNT, RESERVE_A_DEPOSIT_AMOUNT, RESERVE_B_ASSET_TYPE, RESERVE_B_ASSET_ID, RESERVE_B_ASSET_CODE, RESERVE_B_ASSET_ISSUER, RESERVE_B_MAX_AMOUNT, RESERVE_B_DEPOSIT_AMOUNT, MIN_PRICE, MIN_PRICE_R, MAX_PRICE, MAX_PRICE_R, SHARES_RECEIVED, RESERVE_A_MIN_AMOUNT, RESERVE_B_MIN_AMOUNT, SHARES, RESERVE_A_WITHDRAW_AMOUNT, RESERVE_B_WITHDRAW_AMOUNT, OP_SOURCE_ACCOUNT, OP_SOURCE_ACCOUNT_MUXED, TRANSACTION_ID, TYPE, TRANSACTION_HASH, LEDGER_SEQUENCE, TXN_ACCOUNT, ACCOUNT_SEQUENCE, MAX_FEE, TXN_OPERATION_COUNT, TXN_CREATED_AT, MEMO_TYPE, MEMO, TIME_BOUNDS, SUCCESSFUL, FEE_CHARGED, FEE_ACCOUNT, NEW_MAX_FEE, ACCOUNT_MUXED, FEE_ACCOUNT_MUXED, LEDGER_HASH, PREVIOUS_LEDGER_HASH, TRANSACTION_COUNT, LEDGER_OPERATION_COUNT, CLOSED_AT, LEDGER_ID, TOTAL_COINS, FEE_POOL, BASE_FEE, BASE_RESERVE, MAX_TX_SET_SIZE, PROTOCOL_VERSION, SUCCESSFUL_TRANSACTION_COUNT, FAILED_TRANSACTION_COUNT, BATCH_ID, BATCH_RUN_DATE, BATCH_INSERT_TS, LEDGER_BOUNDS, MIN_ACCOUNT_SEQUENCE, MIN_ACCOUNT_SEQUENCE_AGE, MIN_ACCOUNT_SEQUENCE_LEDGER_GAP, EXTRA_SIGNERS, ASSET_BALANCE_CHANGES, PARAMETERS, PARAMETERS_DECODED, FUNCTION, ADDRESS, SOROBAN_OPERATION_TYPE, EXTEND_TO, CONTRACT_ID, CONTRACT_CODE_HASH, RESOURCE_FEE, SOROBAN_RESOURCES_INSTRUCTIONS, SOROBAN_RESOURCES_READ_BYTES, SOROBAN_RESOURCES_WRITE_BYTES, TRANSACTION_RESULT_CODE, INCLUSION_FEE_BID, INCLUSION_FEE_CHARGED, RESOURCE_FEE_REFUND, OPERATION_RESULT_CODE, OPERATION_TRACE_CODE, OP_APPLICATION_ORDER, TXN_APPLICATION_ORDER'
) }}
